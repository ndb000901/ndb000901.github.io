<?xml version="1.0"?>
<rss version="2.0">
    <channel>
        <title>wuhen&#39;s blog • Posts by &#34;python&#34; tag</title>
        <link>http://example.com</link>
        <description></description>
        <language>zh-CN</language>
        <pubDate>Sat, 08 May 2021 03:50:11 +0800</pubDate>
        <lastBuildDate>Sat, 08 May 2021 03:50:11 +0800</lastBuildDate>
        <category>计算机网络</category>
        <category>C#</category>
        <category>C</category>
        <category>软件安装</category>
        <category>linux</category>
        <category>php</category>
        <category>Java</category>
        <category>python</category>
        <category>shell</category>
        <category>博客搭建</category>
        <category>git</category>
        <item>
            <guid isPermalink="true">http://example.com/2021/05/08/opencv%E5%A4%84%E7%90%86%E5%9B%BE%E7%89%87/</guid>
            <title>opencv处理图片</title>
            <link>http://example.com/2021/05/08/opencv%E5%A4%84%E7%90%86%E5%9B%BE%E7%89%87/</link>
            <category>python</category>
            <pubDate>Sat, 08 May 2021 03:50:11 +0800</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;opencv处理图片&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#opencv处理图片&#34;&gt;#&lt;/a&gt; opencv 处理图片&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;1. 实验环境&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;1.manjaro21-gnome&lt;/p&gt;
&lt;p&gt;2.python3.9&lt;/p&gt;
&lt;p&gt;3.opencv-python-4.5.1.48&lt;/p&gt;
&lt;p&gt;4.numpy-1.20.2&lt;/p&gt;
&lt;/blockquote&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;p&gt;&lt;strong&gt;2. 加载、显示、保存图片&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;# 加载、显示、保存图片&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;import cv2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;img &amp;#x3D; cv2.imread(&amp;quot;1.jpeg&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cv2.imwrite(&amp;quot;save.png&amp;quot;, img)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cv2.imshow(&amp;quot;img&amp;quot;, img)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cv2.waitKey()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;2. 获取图片宽、高、通道数&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;# 获取图片宽、高、通道数&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;import cv2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;img &amp;#x3D; cv2.imread(&amp;quot;1.jpeg&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;print(img.shape)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;输出结果&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;返回图片的高、宽、通道，若图像为非彩色图，则不返回通道值。&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;(750, 500, 3)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;3. 图像缩放&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;图像缩放使用 cv2.resize () 函数，第三个参数定义了缩放插值的方法。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;参数&lt;/th&gt;
&lt;th&gt;说明&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;INTER_NEAREST&lt;/td&gt;
&lt;td&gt;最近邻插值法&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;INTER_LINEAR&lt;/td&gt;
&lt;td&gt;双线性插值法（默认）&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;INTER_AREA&lt;/td&gt;
&lt;td&gt;基于局部像素的重采样&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;INTER_CUBIC&lt;/td&gt;
&lt;td&gt;基于 4x4 像素邻域的 3 次插值法&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;INTER_LANCZOS4&lt;/td&gt;
&lt;td&gt;基于 8x8 像素邻域的 Lanczos 插值&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;# 图像缩放&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;import cv2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;img &amp;#x3D; cv2.imread(&amp;quot;1.jpeg&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cv2.imshow(&amp;quot;img&amp;quot;, img)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;img1 &amp;#x3D; cv2.resize(img, (100, 600), cv2.INTER_AREA)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;hight, width &amp;#x3D; img.shape[0:2]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;img2 &amp;#x3D; cv2.resize(img, (width, hight))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cv2.imshow(&amp;quot;img1&amp;quot;, img1)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cv2.imshow(&amp;#39;img2&amp;#39;, img2)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cv2.waitKey()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;4. 图片旋转&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;a href=&#34;http://main.py&#34;&gt;main.py&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;import numpy as np&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;import argparse&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;import imutils&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;import cv2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ap &amp;#x3D; argparse.ArgumentParser()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ap.add_argument(&amp;quot;-i&amp;quot;, &amp;quot;--image&amp;quot;, required&amp;#x3D;True,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                help&amp;#x3D;&amp;quot;Path to the image&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;args &amp;#x3D; vars(ap.parse_args())&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;image &amp;#x3D; cv2.imread(args[&amp;quot;image&amp;quot;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cv2.imshow(&amp;quot;Original&amp;quot;, image)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;(h, w) &amp;#x3D; image.shape[:2]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;center &amp;#x3D; (w &amp;#x2F;&amp;#x2F; 2, h &amp;#x2F;&amp;#x2F; 2)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;M &amp;#x3D; cv2.getRotationMatrix2D(center, 45, 1.0)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;rotated &amp;#x3D; cv2.warpAffine(image, M, (w, h))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cv2.imshow(&amp;quot;Rotated by 45 Degrees&amp;quot;, rotated)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;M &amp;#x3D; cv2.getRotationMatrix2D(center, -90, 1.0)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;rotated &amp;#x3D; cv2.warpAffine(image, M, (w, h))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cv2.imshow(&amp;quot;Rotated by -90 Degrees&amp;quot;, rotated)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;rotated &amp;#x3D; imutils.rotate(image, 180)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cv2.imshow(&amp;quot;Rotated by 180 Degrees&amp;quot;, rotated)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cv2.waitKey(0)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;&lt;a href=&#34;http://imutils.py&#34;&gt;imutils.py&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;rotate () 第一个参数为需要处理的图片，第二个为角度，第三个为旋转中心，默认为图片中心，第四个为规模，默认 1.0。&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;import cv2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;def rotate(image, angle, center&amp;#x3D;None, scale&amp;#x3D;1.0):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    (h, w) &amp;#x3D; image.shape[:2]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    if center is None: &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        center &amp;#x3D; (w &amp;#x2F;&amp;#x2F; 2, h &amp;#x2F;&amp;#x2F; 2)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    M &amp;#x3D; cv2.getRotationMatrix2D(center, angle, scale)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    rotated &amp;#x3D; cv2.warpAffine(image, M, (w, h))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    return rotated&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;5. 图像轮廓检测&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;# 图片轮廓检测&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;import cv2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;import numpy as np&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;img &amp;#x3D; cv2.imread(&amp;#39;1.jpeg&amp;#39;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;gray &amp;#x3D; cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)                        #转换为灰度图像&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ret, binary &amp;#x3D; cv2.threshold(gray, 127, 255, cv2.THRESH_BINARY)        #转换为二值图像&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;contours, hierarchy &amp;#x3D; cv2.findContours(binary, cv2.RETR_TREE, cv2.CHAIN_APPROX_SIMPLE)#提取轮廓&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cv2.drawContours(img, contours, -1, (0, 0, 255), 2)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cv2.imshow(&amp;quot;img&amp;quot;, img)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cv2.waitKey()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/2021/05/08/python%20opencv%20%E6%93%8D%E4%BD%9C%E6%91%84%E5%83%8F%E5%A4%B4/</guid>
            <title>python opencv 操作摄像头</title>
            <link>http://example.com/2021/05/08/python%20opencv%20%E6%93%8D%E4%BD%9C%E6%91%84%E5%83%8F%E5%A4%B4/</link>
            <category>python</category>
            <pubDate>Sat, 08 May 2021 03:50:11 +0800</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;python-opencv-操作摄像头&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#python-opencv-操作摄像头&#34;&gt;#&lt;/a&gt; python opencv 操作摄像头&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;1. 实验环境&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;1.win10&lt;/p&gt;
&lt;p&gt;2.python3.8&lt;/p&gt;
&lt;p&gt;3.opencv-4.4.0.46&lt;/p&gt;
&lt;/blockquote&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;p&gt;&lt;strong&gt;2. 源码&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://main.py&#34;&gt;main.py&lt;/a&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;import cv2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;import numpy as np&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cap &amp;#x3D; cv2.VideoCapture(0)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;while 1:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    # get a frame&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ret, frame &amp;#x3D; cap.read()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    # show a frame&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    cv2.imshow(&amp;quot;capture&amp;quot;, frame)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    if cv2.waitKey(1) &amp;amp; 0xFF &amp;#x3D;&amp;#x3D; ord(&amp;#39;q&amp;#39;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        break&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cap.release()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cv2.destroyAllWindows()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;3. 效果&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/48900845/112761669-db797e80-902e-11eb-81e4-9545c2243094.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;作者 info&lt;/p&gt;
&lt;p&gt;作者：DebugWuhen&lt;/p&gt;
&lt;p&gt;原创公众号：『DebugWuhen』，专注于记录有趣的编程技术和有益的程序人生，期待你的关注。&lt;/p&gt;
&lt;p&gt;转载说明：务必注明来源（注明：来源于公众号：DebugWuhen， 作者：DebugWuhen）&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/48900845/112752163-3b0e6480-9004-11eb-899d-66ddef749c2b.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;/blockquote&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/2021/05/08/python%20%E8%BF%9E%E6%8E%A5sql%20server%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%8Cpymssql%E6%A8%A1%E5%9D%97%E5%AE%89%E8%A3%85%E3%80%82/</guid>
            <title>python 连接sql server数据库，pymssql模块安装。</title>
            <link>http://example.com/2021/05/08/python%20%E8%BF%9E%E6%8E%A5sql%20server%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%8Cpymssql%E6%A8%A1%E5%9D%97%E5%AE%89%E8%A3%85%E3%80%82/</link>
            <category>python</category>
            <pubDate>Sat, 08 May 2021 03:50:11 +0800</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;python-连接sql-server数据库pymssql模块安装&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#python-连接sql-server数据库pymssql模块安装&#34;&gt;#&lt;/a&gt; python 连接 sql server 数据库，pymssql 模块安装。&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;python 版本：python3.7&lt;/p&gt;
&lt;p&gt;数据库版本：sql server 2016&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;连接 sql server 数据库，本菜鸟用的是 pymssql，现在我得着重说下 pymssql 的安装问题。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;安装 pymssql 解决方案&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;往常使用滴 pip install pymssql 可能行不通（你可以去试试，反正我滴机子不行）。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;资源下载&lt;/strong&gt; &lt;a href=&#34;https://pypi.org/project/pymssql/#files&#34;&gt;pymssql 下载&lt;/a&gt;&lt;br&gt;
选择自己需要滴版本&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/48900845/112761694-0794ff80-902f-11eb-8561-d8e1a2d3d6a4.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;p&gt;下载后直接在当前目录执行&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;pip install 包名&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;p&gt;&lt;strong&gt;连接数据库&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;import pymssql&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;class MSSQL:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    def __init__(self,host,user,pwd,db):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        self.host &amp;#x3D; host&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        self.user &amp;#x3D; user&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        self.pwd &amp;#x3D; pwd&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        self.db &amp;#x3D; db&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    def __GetConnect(self):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        if not self.db:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            raise(NameError,&amp;quot;没有设置数据库信息&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        self.conn &amp;#x3D; pymssql.connect(host&amp;#x3D;self.host,user&amp;#x3D;self.user,password&amp;#x3D;self.pwd,database&amp;#x3D;self.db,charset&amp;#x3D;&amp;quot;utf8&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        cur &amp;#x3D; self.conn.cursor()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        if not cur:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            raise(NameError,&amp;quot;连接数据库失败&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        else:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            return cur&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    def ExecQuery(self,sql):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        cur &amp;#x3D; self.__GetConnect()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        cur.execute(sql)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        resList &amp;#x3D; cur.fetchall()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        #查询完毕后必须关闭连接&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        self.conn.close()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        return resList&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    def ExecNonQuery(self,sql):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        cur &amp;#x3D; self.__GetConnect()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        cur.execute(sql)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        self.conn.commit()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        self.conn.close()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#根据自己的实际情况进行配置&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ms &amp;#x3D; MSSQL(host&amp;#x3D;&amp;quot;127.0.0.1&amp;quot;,user&amp;#x3D;&amp;quot;sa&amp;quot;,pwd&amp;#x3D;&amp;quot;123456&amp;quot;,db&amp;#x3D;&amp;quot;haha&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sqlStr &amp;#x3D; &amp;#39;select * from jokes&amp;#39;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;list &amp;#x3D; ms.ExecQuery(sqlStr.encode(&amp;#39;utf-8&amp;#39;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;for i in list:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    print(i)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;作者 info&lt;/p&gt;
&lt;p&gt;作者：DebugWuhen&lt;/p&gt;
&lt;p&gt;原创公众号：『DebugWuhen』，专注于记录有趣的编程技术和有益的程序人生，期待你的关注。&lt;/p&gt;
&lt;p&gt;转载说明：务必注明来源（注明：来源于公众号：DebugWuhen， 作者：DebugWuhen）&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/48900845/112752163-3b0e6480-9004-11eb-899d-66ddef749c2b.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;/blockquote&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/2021/05/08/python%E5%88%9D%E8%AF%95opencv/</guid>
            <title>python 初试opencv</title>
            <link>http://example.com/2021/05/08/python%E5%88%9D%E8%AF%95opencv/</link>
            <category>python</category>
            <pubDate>Sat, 08 May 2021 03:50:11 +0800</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;python-初试opencv&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#python-初试opencv&#34;&gt;#&lt;/a&gt; python 初试 opencv&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;1. 实验环境&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;1.win10&lt;/p&gt;
&lt;p&gt;2.python3.8&lt;/p&gt;
&lt;p&gt;3.opencv-4.4.0.46&lt;/p&gt;
&lt;p&gt;4.matplotlib-3.3.2&lt;/p&gt;
&lt;/blockquote&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;p&gt;&lt;strong&gt;2. 源码&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://main.py&#34;&gt;main.py&lt;/a&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;#!&amp;#x2F;usr&amp;#x2F;bin&amp;#x2F;env python3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;# -*- coding: utf-8 -*-&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;import cv2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;from pylab import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;# 载入图像&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;im &amp;#x3D; cv2.imread(&amp;#39;1.jpg&amp;#39;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;# 颜色空间转换&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;gray &amp;#x3D; cv2.cvtColor(im, cv2.COLOR_BGR2GRAY)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;# 显示原始图像&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;fig &amp;#x3D; plt.figure()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;subplot(121)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.gray()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;imshow(im)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;title(u&amp;#39;彩色图&amp;#39;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;axis(&amp;#39;off&amp;#39;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;# 显示灰度化图像&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.subplot(122)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.gray()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;imshow(gray)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;title(u&amp;#39;灰度图&amp;#39;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;axis(&amp;#39;off&amp;#39;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;show()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;效果图&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/48900845/112761716-2dba9f80-902f-11eb-925c-aec4491487ee.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;作者 info&lt;/p&gt;
&lt;p&gt;作者：DebugWuhen&lt;/p&gt;
&lt;p&gt;原创公众号：『DebugWuhen』，专注于记录有趣的编程技术和有益的程序人生，期待你的关注。&lt;/p&gt;
&lt;p&gt;转载说明：务必注明来源（注明：来源于公众号：DebugWuhen， 作者：DebugWuhen）&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/48900845/112752163-3b0e6480-9004-11eb-899d-66ddef749c2b.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;/blockquote&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/2021/05/08/python%E9%80%9A%E8%BF%87%E9%82%AE%E4%BB%B6%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6%E7%94%B5%E8%84%91/</guid>
            <title>让繁琐的工作自动化——python处理email</title>
            <link>http://example.com/2021/05/08/python%E9%80%9A%E8%BF%87%E9%82%AE%E4%BB%B6%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6%E7%94%B5%E8%84%91/</link>
            <category>python</category>
            <pubDate>Sat, 08 May 2021 03:50:11 +0800</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;让繁琐的工作自动化python处理email&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#让繁琐的工作自动化python处理email&#34;&gt;#&lt;/a&gt; 让繁琐的工作自动化 ——python 处理 email&lt;/h2&gt;
&lt;p&gt;今天来谈一谈，如何用 python 处理 Email。今天的示例选用 QQ 邮箱。&lt;/p&gt;
&lt;p&gt;以及写个利用邮件远程控制电脑下载图片。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;1. 环境&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;1.python3.8&lt;/p&gt;
&lt;p&gt;2.pyzmail36 v1.04&lt;/p&gt;
&lt;p&gt;3.IMAPClient v2.1.0&lt;/p&gt;
&lt;p&gt;4.PyEmail v0.0.1&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;如果 pyzmail 安装报错，请安装 pyzmail36。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/48900845/112761745-5b074d80-902f-11eb-9087-99fe74011332.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;p&gt;&lt;strong&gt;2. 准备工作&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;需要准备个 qq 邮箱，这个很容易吧。&lt;/p&gt;
&lt;p&gt;网页登录 qq 邮箱，点击设置，点击账户。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/48900845/112761792-7d00d000-902f-11eb-9476-a7852e23885d.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;p&gt;开启 IMAP/SMTP 服务。会生成一个授权码，把它记下来，后面需要用，这玩意相当于密码。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/48900845/112761796-82f6b100-902f-11eb-8e3d-bfdd35a12978.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;p&gt;QQ 邮箱的一些信息，后面需要用&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/48900845/112761800-89852880-902f-11eb-859d-d55b56cdc77b.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;3. 发送邮件&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;导入 smtplib&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;import smtplib&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;连接到 SMTP 服务器，smtplib.SMTP ()，第一个参数是 SMTP 服务器的域名，第二个是端口。&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;smtpObj &amp;#x3D; smtplib.SMTP(&amp;#39;smtp.qq.com&amp;#39;, 587)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;给服务器打个招呼，问个好。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;注意：得到 SMTP 对象后必须调用 ehlo () 方法，向 SMTP 服务器问好。&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;smtpObj.ehlo()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;如果连接 SMTP 587 端口（使用 TLS 加密），需要调用 starttls ()；如果连接 SMTP 465 端口（使用 SSL），加密一设置，无需使用 starttls () 方法，请跳过这一步。&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;smtpObj.starttls()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;登录账号。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;注意：第一个填写邮箱，第二个填生成的授权码&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;smtpObj.login(&amp;#39;xxxxxx@qq.com&amp;#39;, &amp;#39;passwd&amp;#39;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;发送邮件。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;注意：第一个参数填写登录的邮箱，第二个参数目的邮箱，第三个参数正文内容，必须以字符串’Subject: \n’开头，作为邮件的主题行，’\n’将正文与主题分割。&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;smtpObj.sendmail(&amp;#39;你的邮箱&amp;#39;,&amp;#39;目的邮箱&amp;#39;,&amp;#39;Subject: haha\nhello,nie.&amp;#39;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;与 SMTP 服务器断开。&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;smtpObj.quit()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/48900845/112761828-a15cac80-902f-11eb-8694-27af6d354457.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;4. 获取邮件与删除邮件&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;导入模块&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;import pyzmail&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;import imapclient&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;import imaplib&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;连接 IMAP 服务器，imapclient.IMAPClient（）方法第一个参数 IMAP 服务器域名，第二个参数开启 SSL 加密（大多数邮件提供商要求开启 SSL 加密）&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;imapObj &amp;#x3D; imapclient.IMAPClient(&amp;#39;imap.qq.com&amp;#39;, ssl&amp;#x3D;True)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;登录到 IMAP 服务器&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;注意：第一个参数你滴邮箱，第二个参数生成的授权码&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;imapObj.login(&amp;#39;xxxxxxx@qq.com&amp;#39;, &amp;#39;passwd&amp;#39;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;选择文件夹，文件夹有很多，可以通过 list_folders () 方法获取文件夹列表（返回元组类型）。&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;list1 &amp;#x3D; imapObj.list_folders()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;注意：我为了输出好看，导入了 pprint 模块，调用 pprint.pprint (list1) 输出&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/48900845/112761848-bdf8e480-902f-11eb-96a7-a61b1984039f.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;p&gt;选择文件夹，一般都有‘INBOX’(收件箱) 这个文件夹，readonly 是只读，如果你的程序不需删除邮件，建议将该参数设置为 True。&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;imapObj.select_folder(&amp;#39;INBOX&amp;#39;, readonly&amp;#x3D;True)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;搜索，search () 方法参数是字符串列表文末附录查看搜索键。该方法返回消息 ID 列表。&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;MIds &amp;#x3D; imapObj.search([&amp;#39;ALL&amp;#39;])&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;注意：若你的搜索有大量数据，python 会抛出异常，请加入以下代码，数字代表最大字节数&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;import imaplib&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;imaplib._MAXLINE &amp;#x3D; 100000000&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/48900845/112761859-c9e4a680-902f-11eb-8462-ad0d53440cc3.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;p&gt;获取电子邮件内容，以下代码获取了 4 个 eamil 的信息。&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;msgList &amp;#x3D; imapObj.fetch(MIds, [&amp;#39;BODY[]&amp;#39;])&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;获取电子邮件的一些信息，为了操作简洁，先导入 pyzmail 模块，创建 PyzMessage 对象，使解析电子邮件变得更方便。&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;import pyzmail&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;msg &amp;#x3D; pyzmail.PyzMessage.factory(msgList[10][b&amp;#39;BODY[]&amp;#39;])&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;获取主题&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;subject &amp;#x3D; msg.get_subject()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;获取地址&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;注意：‘from’ 可替换为’to’,‘cc’,‘bcc’。cc 指抄送，bcc 指密送。&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;addr &amp;#x3D; msg.get_addresses(&amp;#39;from&amp;#39;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;获取正文，email 可以是纯文本或 HTML 的混合，若 email 只含纯文本 PyzMwssage 对象的 html_part 设置为 None；若 email 只含 HTML，PyzMwssage 对象的 text_part 设置为 None。&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;if msg.text_part !&amp;#x3D; None:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	text &amp;#x3D; msg.text_part.get_payload().decode(msg.text_part.charset)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;if msg.html_part !&amp;#x3D; None:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	html &amp;#x3D; msg.html_part.get_payload().decode(msg.html_part.charset)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;删除电子邮件&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;imapObj.select_folder(&amp;#39;INBOX&amp;#39;, readonly&amp;#x3D;False)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;imapObj.delete_messages(消息ID)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;与 IMAP 服务器断开&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;imapObj.logout()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;hr&gt;
&lt;h2 id=&#34;实例实现通过邮件远程控制电脑下载图片&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#实例实现通过邮件远程控制电脑下载图片&#34;&gt;#&lt;/a&gt; 实例 —— 实现通过邮件远程控制电脑下载图片。&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/48900845/112761882-e680de80-902f-11eb-8ab8-f098427ffb0a.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;p&gt;这不就下载好了吗&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/48900845/112761886-ee408300-902f-11eb-85ae-85f5401dcf85.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;注意：本例子写得太过于粗糙，有太多的问题需要修改。仅仅是为大家演示一种使用思路。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;源码&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;import imaplib&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;import pyzmail&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;import imapclient&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;import time&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;import requests&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;def download(urls):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    for url in urls:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        res &amp;#x3D; requests.get(url.replace(&amp;#39;&amp;amp;&amp;#39;, &amp;#39;&amp;amp;&amp;#39;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        with open(str(time.time()) + &amp;#39;.jpg&amp;#39;, &amp;#39;wb&amp;#39;) as file:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            file.write(res.content)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;def checknewpic():&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    imapObj &amp;#x3D; imapclient.IMAPClient(&amp;#39;imap.qq.com&amp;#39;, ssl&amp;#x3D;True)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    imapObj.login(&amp;#39;xxxxx@qq.com&amp;#39;, &amp;#39;passwd&amp;#39;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    print(imapObj.select_folder(&amp;#39;INBOX&amp;#39;, readonly&amp;#x3D;True))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    MIds &amp;#x3D; imapObj.search([&amp;#39;ALL&amp;#39;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    msgList &amp;#x3D; imapObj.fetch(MIds, [&amp;#39;BODY[]&amp;#39;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    for id in MIds:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        msg &amp;#x3D; pyzmail.PyzMessage.factory(msgList[id][b&amp;#39;BODY[]&amp;#39;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        if msg.get_subject() &amp;#x3D;&amp;#x3D; &amp;quot;下载图片&amp;quot;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            if msg.text_part !&amp;#x3D; None:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                urls &amp;#x3D; msg.text_part.get_payload().decode(msg.text_part.charset).split(&amp;#39;^&amp;#39;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                download(urls)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;while True:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    checknewpic()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    time.sleep(60)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;print(&amp;#39;---------执行完毕-----------&amp;#39;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;hr&gt;
&lt;h2 id=&#34;附录&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#附录&#34;&gt;#&lt;/a&gt; 附录&lt;/h2&gt;
&lt;p&gt;‘ALL’：返回该文件夹中的所有邮件。如果你请求一个大文件夹中的所有信息，可能会遇到 imaplib 的大小限制&lt;/p&gt;
&lt;p&gt;‘BEFORE/ON/SINCE date’：分别返回给定的 date 之前、当天、之后 IMAP 服务器接受的消息，日期格式必须是 01-Jul-2020&lt;br&gt;
 此外，虽然 “SINCE 01-Jul-2020” 将匹配 7 月 1 日当天和之后的消息，但是 “BEFORE 01-Jul-2020” 仅匹配 7 月 1 日之前的消息，不包括 7 月 1 日当天&lt;/p&gt;
&lt;p&gt;‘SUBJECT/BODY/TEXT string’: 分别返回 string 出现在主题、正文、主题或正文中的消息，如果 string 中有空格，就是用双引号&lt;/p&gt;
&lt;p&gt;‘FROM/TO/CC/BCC string’: 返回所有信息，其中 string 分别出现在 “from” 邮件地址、“to” 邮件地址、“cc”（抄送）地址、或 “bcc”（密件抄送）地址&lt;br&gt;
如果 string 中有多个邮件地址，就是用空格将他们分割开，并使用双引号&lt;/p&gt;
&lt;p&gt;‘SEEN/UNSEEN’：分别返回包含和不包含 \Seen 标记的所有信息。如果电子邮件已经被 fetch () 方法调用访问，或者你曾在电子邮件程序中或网络浏览器中点击过它，&lt;br&gt;
就会有 \Seen 标记，比较常用的说法是 “已读” 而不是 “已看”&lt;/p&gt;
&lt;p&gt;‘ANSWERED/UNANSERED’: 分别返回包含和不包含 \Answered 标记的所有信息，如果消息已答复就会有 \Answered 标记&lt;/p&gt;
&lt;p&gt;‘DELERED/UNDELETED’: 分别返回包含和不包含 \Deleted 标记的所有信息，用 delete_messages () 方法删除的邮件就会有 \Deleted 标记，直到调用 expunge () 方法才&lt;br&gt;
会永久删除&lt;/p&gt;
&lt;p&gt;‘DRAFT/UNDRAFT’：分别返回包含和不包含 \Draft 标记的所有信息，草稿邮件通常保存在单独的草稿文件夹中，而不是收件箱&lt;/p&gt;
&lt;p&gt;‘FLAGGED/UNFLAGGED’：分别返回包含和不包含 \Flagged 标记的所有信息，这个标记通常用来标记电子邮件的 “重要” 或 “紧急”&lt;/p&gt;
&lt;p&gt;‘LARGER/SMALLER N’：分别返回大于或小于 N 个字节的所有信息&lt;/p&gt;
&lt;p&gt;‘NOT search-key’: 返回搜索键不会返回的那些信息&lt;/p&gt;
&lt;p&gt;‘OR search-key1 search-key2’: 返回符合第一个或者第二个搜索键的信息&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;作者 info&lt;/p&gt;
&lt;p&gt;作者：DebugWuhen&lt;/p&gt;
&lt;p&gt;原创公众号：『DebugWuhen』，专注于记录有趣的编程技术和有益的程序人生，期待你的关注。&lt;/p&gt;
&lt;p&gt;转载说明：务必注明来源（注明：来源于公众号：DebugWuhen， 作者：DebugWuhen）&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/48900845/112752163-3b0e6480-9004-11eb-899d-66ddef749c2b.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;/blockquote&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/2021/05/08/%E5%A4%84%E7%90%86Ubuntu%20python%E5%A4%9A%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86%E9%97%AE%E9%A2%98/</guid>
            <title>处理Ubuntu python多版本管理问题</title>
            <link>http://example.com/2021/05/08/%E5%A4%84%E7%90%86Ubuntu%20python%E5%A4%9A%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86%E9%97%AE%E9%A2%98/</link>
            <category>python</category>
            <pubDate>Sat, 08 May 2021 03:50:11 +0800</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;处理ubuntu-python多版本管理问题&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#处理ubuntu-python多版本管理问题&#34;&gt;#&lt;/a&gt; 处理 Ubuntu python 多版本管理问题&lt;/h2&gt;
&lt;p&gt;前几天在 Ubuntu 遇到了 Python 多版本问题，今天心血来潮，想把自己摸索到的方法记录下来。&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;系统安装的Python版本&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;python2.7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;python3.6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;python3.7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;系统pip版本&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;pip&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;pip2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;pip3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;当我用 python3.7 开发程序时，需要用 pip3 安装依赖包，pip3 总是把包给我搞到 python3.6 下，让我很不爽。&lt;br&gt;
下面介绍一种解决方法：&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;p&gt;1. 找到 python,pip 所在目录。&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;我的系统在&amp;#x2F;usr&amp;#x2F;bin&amp;#x2F;路径下。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;命令 cd &amp;#x2F;usr&amp;#x2F;bin&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;查看一下 ls -l&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/48900845/112761926-1af49a80-9030-11eb-9ae6-9146358eff7b.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/48900845/112761932-1f20b800-9030-11eb-887e-3b0346ee50e8.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;p&gt;冒绿光的是可以执行滴文件&lt;/p&gt;
&lt;p&gt;冒蓝光的是链接文件 (您可以理解为类似 Windows 的快捷方式)&lt;/p&gt;
&lt;p&gt;要想更改 pip3 install 的安装位置，可以这么操作。&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;编辑pip3(这玩意就是个Python脚本)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;vim pip3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/48900845/112761941-28aa2000-9030-11eb-95f1-7efe414f8d3f.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;p&gt;将第一行的 python 版本修改你想要的版本，然后保存，问题就解决喽。&lt;/p&gt;
&lt;p&gt;另一个问题就是你在 shell 命令使用 Python 时，Python 版本问题。&lt;/p&gt;
&lt;p&gt;比如你的系统安装了 Python2.7，Python3.6，Python3.7&lt;/p&gt;
&lt;p&gt;这时你在命令窗口&lt;/p&gt;
&lt;p&gt;输入 python2 -----&amp;gt; 使用 Python2.7 版本&lt;/p&gt;
&lt;p&gt;输入 python3 -----&amp;gt; 使用 Python3.6 版本&lt;/p&gt;
&lt;p&gt;如何使用 Python3.7 呢&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;cd &amp;#x2F;usr&amp;#x2F;bin&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;找到python3.7目录（就是找到前面说的冒绿光的python3.7目录）&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;添加软链接&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ln -s &amp;#x2F;usr&amp;#x2F;bin&amp;#x2F;python3.7(找到python3.7的路径) &amp;#x2F;usr&amp;#x2F;bin&amp;#x2F;python3.7 (软链接名字您老随意)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;为啥软连接的路径在 /usr/bin 下呢&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;$PATH&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这些目录应该都可以，你可以试试。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/48900845/112761957-3790d280-9030-11eb-9b88-79752b523601.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;作者 info&lt;/p&gt;
&lt;p&gt;作者：DebugWuhen&lt;/p&gt;
&lt;p&gt;原创公众号：『DebugWuhen』，专注于记录有趣的编程技术和有益的程序人生，期待你的关注。&lt;/p&gt;
&lt;p&gt;转载说明：务必注明来源（注明：来源于公众号：DebugWuhen， 作者：DebugWuhen）&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/48900845/112752163-3b0e6480-9004-11eb-899d-66ddef749c2b.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;/blockquote&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/2021/05/08/%E8%AE%A9%E7%B9%81%E7%90%90%E7%9A%84%E5%B7%A5%E4%BD%9C%E8%87%AA%E5%8A%A8%E5%8C%96%E2%80%94%E2%80%94python%20%E5%A4%84%E7%90%86Excle%E6%96%87%E4%BB%B6/</guid>
            <title>让繁琐的工作自动化——python 处理Excle文件</title>
            <link>http://example.com/2021/05/08/%E8%AE%A9%E7%B9%81%E7%90%90%E7%9A%84%E5%B7%A5%E4%BD%9C%E8%87%AA%E5%8A%A8%E5%8C%96%E2%80%94%E2%80%94python%20%E5%A4%84%E7%90%86Excle%E6%96%87%E4%BB%B6/</link>
            <category>python</category>
            <pubDate>Sat, 08 May 2021 03:50:11 +0800</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;让繁琐的工作自动化python-处理excle文件&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#让繁琐的工作自动化python-处理excle文件&#34;&gt;#&lt;/a&gt; 让繁琐的工作自动化 ——python 处理 Excle 文件&lt;/h2&gt;
&lt;p&gt;今天收到一个省市县区的 Excle 表格，想着整理一下数据，将信息整理为层级关系（省–&amp;gt; 市–&amp;gt;(县 / 区)）存到字典里，以备不时之需。&lt;br&gt;
打开一看，MD，3 千行数据，这 TM 要搞到神马时候。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/48900845/112762066-80e12200-9030-11eb-80a8-b888769e0f84.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/48900845/112762072-850d3f80-9030-11eb-924b-7d7a213bfe2e.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;叮铃铃～～～～叮铃铃～～～～，人生苦短，我用 python。开搞！！！&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;openpyxl的基础使用&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#openpyxl的基础使用&#34;&gt;#&lt;/a&gt; &lt;strong&gt;openpyxl 的基础使用&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;环境&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;1.pycharm2020.1&lt;/p&gt;
&lt;p&gt;2.python3.8&lt;/p&gt;
&lt;p&gt;3.openpyxl 2.1.4&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;openpyxl 已经更新到 3 点多了，我这里演示的是&lt;strong&gt; openpyxl 2.1.4&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;导入 openpyxl 模块&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;import openpyxl&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;p&gt;&lt;strong&gt;读取操作&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;打开要处理的文件，该函数需要传入一个文件路径。wb 是一个 Workbook 对象。&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;wb &amp;#x3D; openpyxl.load_workbook(&amp;quot;省市县区.xlsx&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Excel 文档有多个 sheet 组成。&lt;/p&gt;
&lt;p&gt;获得 Excel 文档所有 sheet。&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;sheetList &amp;#x3D; wb.get_sheet_names()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;根据 sheet 名字获取对应表。表由一个 Worksheet 对象表示，sheet 就是一个 Worksheet 对象。&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;sheet &amp;#x3D; wb.get_sheet_by_name(&amp;quot;sheet名字&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;取得 sheet 表格中的值&lt;/p&gt;
&lt;p&gt;数值定位：row 是行号，column 是列号。&lt;/p&gt;
&lt;p&gt;字符定位：Excle 用字母表示列，数字表示行。&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;x &amp;#x3D; sheet.cell(row&amp;#x3D;1, column&amp;#x3D;1).value #第一种表示&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;y &amp;#x3D; sheet[&amp;#39;A1&amp;#39;].value #第二种表示&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;列字母和数字之间的转换。&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;openpyxl.cell.column_index_from_string()   #字母----&amp;gt;数字&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;openpyxl.cell.column_letter()                        #数字----&amp;gt;字母&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;获取 sheet 有多大。&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;sheet.get_highest_row()        #返回行数&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sheet.get_highest_column()  #返回列数&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;遍历 sheet&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;for i in range(1, sheet.get_highest_row()  + 1):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    for j in range(1, sheet.get_highest_column()  + 1):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        print(str(sheet1.cell(row&amp;#x3D;i, column&amp;#x3D;j).value) + &amp;quot; &amp;quot;, end&amp;#x3D;&amp;quot;&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    print()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;写入操作&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;创建新的 Workbook 对象。&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;wb &amp;#x3D; openpyxl.Workbook()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;保存文件。(传入文件名)&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;wb.save(&amp;quot;haha.xlsx&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;创建 sheet，index 表示 sheet 的次序，title 表示 sheet 的名字。&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;wb.create_sheet(index&amp;#x3D;0,title&amp;#x3D;&amp;#39;haha&amp;#39;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;删除 sheet，需要传入 Worksheet 对象，如果知道 sheet 的名字，就可使用以下代码删除&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;wb.remove_sheet(wb.get_sheet_by_name(&amp;quot;sheet名字&amp;quot;))&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;写入数据&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;sheet.cell(row&amp;#x3D;1, column&amp;#x3D;1) &amp;#x3D; x #第一种表示&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sheet[&amp;#39;A1&amp;#39;] &amp;#x3D; y #第二种表示&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;hr&gt;
&lt;h2 id=&#34;处理表格的源码&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#处理表格的源码&#34;&gt;#&lt;/a&gt; &lt;strong&gt;处理表格的源码&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;原表格公众号回复【省市】获得&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;import pprint&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;import openpyxl&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;wb &amp;#x3D; openpyxl.load_workbook(&amp;quot;省市县区.xlsx&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sheet &amp;#x3D; wb.get_sheet_by_name(&amp;quot;省市县区&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;data &amp;#x3D; &amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;for i in range(2, sheet.get_highest_row() + 1):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    province &amp;#x3D; sheet.cell(row&amp;#x3D;i, column&amp;#x3D;1).value&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    city &amp;#x3D; sheet.cell(row&amp;#x3D;i, column&amp;#x3D;2).value&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    county &amp;#x3D; sheet.cell(row&amp;#x3D;i, column&amp;#x3D;3).value&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    data.setdefault(province, &amp;#123;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    data[province].setdefault(city, [])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    if data[province][city].count(county) &amp;#x3D;&amp;#x3D; 0:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        data[province][city].append(county)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;print(&amp;quot;数据整理完毕，开始写入文件&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;with open(&amp;quot;cityInfo.py&amp;quot;, &amp;quot;w&amp;quot;, encoding&amp;#x3D;&amp;#39;utf-8&amp;#39;) as file:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    file.write(&amp;quot;cityInfo &amp;#x3D; &amp;quot; + pprint.pformat(data))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;print(&amp;quot;文件写入完毕&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;作者 info&lt;/p&gt;
&lt;p&gt;作者：DebugWuhen&lt;/p&gt;
&lt;p&gt;原创公众号：『DebugWuhen』，专注于记录有趣的编程技术和有益的程序人生，期待你的关注。&lt;/p&gt;
&lt;p&gt;转载说明：务必注明来源（注明：来源于公众号：DebugWuhen， 作者：DebugWuhen）&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/48900845/112752163-3b0e6480-9004-11eb-899d-66ddef749c2b.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;/blockquote&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/2021/05/08/%E8%AE%A9%E7%B9%81%E7%90%90%E7%9A%84%E5%B7%A5%E4%BD%9C%E8%87%AA%E5%8A%A8%E5%8C%96%E2%80%94%E2%80%94python%E5%A4%84%E7%90%86CSV%E6%96%87%E4%BB%B6/</guid>
            <title>让繁琐的工作自动化——python处理CSV文件</title>
            <link>http://example.com/2021/05/08/%E8%AE%A9%E7%B9%81%E7%90%90%E7%9A%84%E5%B7%A5%E4%BD%9C%E8%87%AA%E5%8A%A8%E5%8C%96%E2%80%94%E2%80%94python%E5%A4%84%E7%90%86CSV%E6%96%87%E4%BB%B6/</link>
            <category>python</category>
            <pubDate>Sat, 08 May 2021 03:50:11 +0800</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;让繁琐的工作自动化python处理csv文件&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#让繁琐的工作自动化python处理csv文件&#34;&gt;#&lt;/a&gt; 让繁琐的工作自动化 ——python 处理 CSV 文件&lt;/h2&gt;
&lt;p&gt;CSV：CSV 文件是一种简化的电子表格，不同于 Excle (二进制文件)，CSV 是纯文本文件。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;1. 环境&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;1.python3.8&lt;/p&gt;
&lt;p&gt;2.pycharm2020.1&lt;/p&gt;
&lt;/blockquote&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;p&gt;&lt;strong&gt;2. 读取&lt;/strong&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;本期实例数据&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;haha,18,10.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;jiji,16,12.1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;lala,17,11.9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;papa,11,13.3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/48900845/112762127-bb4abf00-9030-11eb-9720-275c57179ad9.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/48900845/112762129-bf76dc80-9030-11eb-9ac9-76ee5b99ab5b.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;首先导入 csv 模块，不需要安装，python 自带的。&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;import csv&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;要想用 csv 模块读取 csv 文件数据，需要先创建一个 Reader 对象，Reader 可以遍历文件的每一行。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;注意：Reader 对象只能循环遍历一次，如果想要再次遍历，需要重新创建。&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;file &amp;#x3D; open(&amp;quot;haha.csv&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;reader &amp;#x3D; csv.reader(file)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;data &amp;#x3D; list(reader)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;print(data)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;以下为在交互式界面操作。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/48900845/112762140-c867ae00-9030-11eb-9532-6a095423bf3c.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;p&gt;使用 Reader 对象遍历数据，Reader.line_num 标志当前遍历到第几行。&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;import csv&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;file &amp;#x3D; open(&amp;quot;haha.csv&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;reader &amp;#x3D; csv.reader(file)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;for row in reader:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    print((&amp;quot;第&amp;#123;&amp;#125;行  &amp;quot; + str(row)).format(reader.line_num))&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;3. 写入&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;将数据写入到 CSV 文件，需要用到 Writer 对象。&lt;/p&gt;
&lt;p&gt;与读取一样，先导入 csv 模块，然后打开文件。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;encoding 是编码；newline 等于空字符，若不设置，在 Windows 系统上，行距会变成下图所示。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/48900845/112762172-e503e600-9030-11eb-90f8-266b1ecbf2ba.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;import csv&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;file &amp;#x3D; open(&amp;#39;haha.csv&amp;#39;, &amp;#39;w&amp;#39;, encoding&amp;#x3D;&amp;#39;utf-8&amp;#39;, newline&amp;#x3D;&amp;#39;&amp;#39;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;创建 Writer 对象，csv.writer () 有两个参数需要注意。&lt;/p&gt;
&lt;p&gt;delimiter： 单元格分隔符，默认为逗号，可以修改为其他。&lt;/p&gt;
&lt;p&gt;lineterminator：行终止符，默认为换行符，可以自行修改。&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;writer &amp;#x3D; csv.writer(file)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;写入数据，使用 writer.writerow（），该函数接受一个列表，返回写入该行的字符数（包括换行符）&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;writer.writerow([&amp;#39;haha&amp;#39;, &amp;#39;18&amp;#39;, &amp;#39;10.0&amp;#39;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;writer.writerow([&amp;#39;jiji&amp;#39;, &amp;#39;16&amp;#39;, &amp;#39;12.1&amp;#39;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;writer.writerow([&amp;#39;lala&amp;#39;, &amp;#39;17&amp;#39;, &amp;#39;11.9&amp;#39;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;writer.writerow([&amp;#39;papa&amp;#39;, &amp;#39;11&amp;#39;, &amp;#39;13.3&amp;#39;])&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;写入完整源码&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;import csv&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;file &amp;#x3D; open(&amp;#39;haha.csv&amp;#39;, &amp;#39;w&amp;#39;, encoding&amp;#x3D;&amp;#39;utf-8&amp;#39;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;writer &amp;#x3D; csv.writer(file)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;writer.writerow([&amp;#39;haha&amp;#39;, &amp;#39;18&amp;#39;, &amp;#39;10.0&amp;#39;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;writer.writerow([&amp;#39;jiji&amp;#39;, &amp;#39;16&amp;#39;, &amp;#39;12.1&amp;#39;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;writer.writerow([&amp;#39;lala&amp;#39;, &amp;#39;17&amp;#39;, &amp;#39;11.9&amp;#39;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;writer.writerow([&amp;#39;papa&amp;#39;, &amp;#39;11&amp;#39;, &amp;#39;13.3&amp;#39;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;file.close()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;原创不易点个赞再走吧&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#原创不易点个赞再走吧&#34;&gt;#&lt;/a&gt; 原创不易，点个赞再走吧。&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;作者 info&lt;/p&gt;
&lt;p&gt;作者：DebugWuhen&lt;/p&gt;
&lt;p&gt;原创公众号：『DebugWuhen』，专注于记录有趣的编程技术和有益的程序人生，期待你的关注。&lt;/p&gt;
&lt;p&gt;转载说明：务必注明来源（注明：来源于公众号：DebugWuhen， 作者：DebugWuhen）&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/48900845/112752163-3b0e6480-9004-11eb-899d-66ddef749c2b.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;/blockquote&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/2021/05/08/%E8%AE%A9%E7%B9%81%E7%90%90%E7%9A%84%E5%B7%A5%E4%BD%9C%E8%87%AA%E5%8A%A8%E5%8C%96%E2%80%94%E2%80%94python%E5%A4%84%E7%90%86JSON%E6%96%87%E4%BB%B6/</guid>
            <title>让繁琐的工作自动化——python处理JSON文件</title>
            <link>http://example.com/2021/05/08/%E8%AE%A9%E7%B9%81%E7%90%90%E7%9A%84%E5%B7%A5%E4%BD%9C%E8%87%AA%E5%8A%A8%E5%8C%96%E2%80%94%E2%80%94python%E5%A4%84%E7%90%86JSON%E6%96%87%E4%BB%B6/</link>
            <category>python</category>
            <pubDate>Sat, 08 May 2021 03:50:11 +0800</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;让繁琐的工作自动化python处理json文件&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#让繁琐的工作自动化python处理json文件&#34;&gt;#&lt;/a&gt; 让繁琐的工作自动化 ——python 处理 JSON 文件&lt;/h2&gt;
&lt;p&gt;不得不说，python 真 TMD 香。由于 python 解析 json 过于简洁，我只好写个实例了，不然文章太短。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;1. 环境&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;1.python3.8&lt;/p&gt;
&lt;p&gt;2.pycharm 2020.1&lt;/p&gt;
&lt;/blockquote&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;p&gt;&lt;strong&gt;2. 读取 JSON 数据&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;当然首先要导入 json 模块&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;import json&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;读取 json 数据&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;data &amp;#x3D; &amp;#39;&amp;#123;&amp;quot;a&amp;quot;:123,&amp;quot;b&amp;quot;:&amp;quot;lala&amp;quot;&amp;#125;&amp;#39;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;result &amp;#x3D; json.loads(data)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;print(result)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;print(result[&amp;#39;a&amp;#39;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;交互式界面&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/48900845/112762217-18df0b80-9031-11eb-9e35-4f17627d66e8.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;3. 写出 JSON 数据&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;导入模块&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;import json&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;输出 json 数据，将 python 字典转为 json 数据&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;data &amp;#x3D; &amp;#123;&amp;#39;a&amp;#39;:1234,&amp;#39;b&amp;#39;:&amp;#39;lalala&amp;#39;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;result &amp;#x3D; json.dumps(data)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;print(result)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/48900845/112762229-20061980-9031-11eb-94fc-64eabfd6889a.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;实例抓取中国地震台网数据解析json数据包&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#实例抓取中国地震台网数据解析json数据包&#34;&gt;#&lt;/a&gt; 实例，抓取中国地震台网数据，解析 JSON 数据包。&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;完整源码&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plain&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;import json&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;import requests&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;res &amp;#x3D; requests.get(&amp;#39;http:&amp;#x2F;&amp;#x2F;news.ceic.ac.cn&amp;#x2F;ajax&amp;#x2F;google&amp;#39;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;text &amp;#x3D; res.text.encode(&amp;#39;utf-8&amp;#39;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;result &amp;#x3D; json.loads(text)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;print(&amp;#39;%-20s&amp;#39; % &amp;#39;id&amp;#39; &amp;#39;%-20s&amp;#39; % &amp;#39;地点&amp;#39; &amp;#39;%-20s&amp;#39; % &amp;#39;震级&amp;#39; &amp;#39;%-20s&amp;#39; % &amp;#39;经度&amp;#39; &amp;#39;%-20s&amp;#39; % &amp;#39;纬度&amp;#39; &amp;#39;%-20s&amp;#39; % &amp;#39;深度&amp;#39; &amp;#39;%-20s&amp;#39; % &amp;#39;时间&amp;#39;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;for e in result:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    print(&amp;#39;%-20s&amp;#39; % str(e[&amp;#39;id&amp;#39;]), &amp;#39;%-20s&amp;#39; % str(e[&amp;#39;LOCATION_C&amp;#39;]), &amp;#39;%-20s&amp;#39; % str(e[&amp;#39;M&amp;#39;]), &amp;#39;%-20s&amp;#39; % str(e[&amp;#39;EPI_LON&amp;#39;]), &amp;#39;%-20s&amp;#39; % str(e[&amp;#39;EPI_LAT&amp;#39;]), &amp;#39;%-20s&amp;#39; % str(e[&amp;#39;EPI_DEPTH&amp;#39;]), &amp;#39;%-20s&amp;#39; % str(e[&amp;#39;O_TIME&amp;#39;]))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;排版有点烂，各位大爷多多包涵。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/48900845/112762239-2c8a7200-9031-11eb-80bb-661790cab334.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/48900845/112762241-30b68f80-9031-11eb-9a31-06ebbd75da8c.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;作者 info&lt;/p&gt;
&lt;p&gt;作者：DebugWuhen&lt;/p&gt;
&lt;p&gt;原创公众号：『DebugWuhen』，专注于记录有趣的编程技术和有益的程序人生，期待你的关注。&lt;/p&gt;
&lt;p&gt;转载说明：务必注明来源（注明：来源于公众号：DebugWuhen， 作者：DebugWuhen）&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://user-images.githubusercontent.com/48900845/112752163-3b0e6480-9004-11eb-899d-66ddef749c2b.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;/blockquote&gt;
 ]]></description>
        </item>
    </channel>
</rss>
