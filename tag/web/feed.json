{
    "version": "https://jsonfeed.org/version/1",
    "title": "wuhen's blog • All posts by \"web\" tag",
    "description": "",
    "home_page_url": "https://blog.wuhen.one",
    "items": [
        {
            "id": "https://blog.wuhen.one/2021/06/02/taoWeb/",
            "url": "https://blog.wuhen.one/2021/06/02/taoWeb/",
            "title": "web作业",
            "date_published": "2021-06-02T11:25:29.432Z",
            "content_html": "<h1 id=\"淘宝优惠券查询\"><a class=\"markdownIt-Anchor\" href=\"#淘宝优惠券查询\">#</a> 淘宝优惠券查询</h1>\n<h2 id=\"项目需求\"><a class=\"markdownIt-Anchor\" href=\"#项目需求\">#</a> 项目需求</h2>\n<p><strong>接入淘宝联盟 - 阿里妈妈 API，开发淘宝商品优惠券查询、分发 Web 站点。通过替商家推广商品，赚取佣金。将 web 站点与 QQ 机器人结合，通过社交软件推广</strong></p>\n<h2 id=\"开发环境\"><a class=\"markdownIt-Anchor\" href=\"#开发环境\">#</a> 开发环境</h2>\n<blockquote>\n<p>1.MDB-Pro-4.12</p>\n<p>2.php-7.2</p>\n<p>3.nginx-1.14.0</p>\n</blockquote>\n<h2 id=\"站点\"><a class=\"markdownIt-Anchor\" href=\"#站点\">#</a> 站点</h2>\n<p><strong>域名被封，由于阿里妈妈身份令牌需要域名备案，不晓得令牌何时失效</strong></p>\n<p><a href=\"http://139.186.201.25/\">http://139.186.201.25/</a></p>\n<span id=\"more\"></span>\n<p><strong>首页</strong></p>\n<p>由于本项目当时结合 QQ 机器人使用，主要使用搜索页面，并没有开发首页。</p>\n<p><strong>搜索结果</strong></p>\n<p><img src=\"https://user-images.githubusercontent.com/48900845/120469981-99c1d700-c3d5-11eb-8338-c7bbb949a99c.png\" alt=\"image\"></p>\n<p><img src=\"https://user-images.githubusercontent.com/48900845/120470024-a7775c80-c3d5-11eb-883e-15fa264f28b8.png\" alt=\"image\"></p>\n<p><strong>商品详情</strong></p>\n<p><img src=\"https://user-images.githubusercontent.com/48900845/120470130-c970df00-c3d5-11eb-98d5-ef5036a6e99e.png\" alt=\"image\"></p>\n<p><strong>QQ 机器人</strong></p>\n<p><strong>由于鹅厂严打，之前开发的 QQ 机器人由于服务商跑路，无法使用</strong></p>\n<h2 id=\"项目需要改进的部分\"><a class=\"markdownIt-Anchor\" href=\"#项目需要改进的部分\">#</a> 项目需要改进的部分</h2>\n<p><strong>1. 不适合高并发场景</strong></p>\n<p><strong>2. 没有接入数据库将一些数据持久化 (API 调用次数每天 10w+，站点流量较小，API 调用次数冗余)</strong></p>\n<p><strong>3. 接入 redis，加快站点访问速度</strong></p>\n<p><strong>4.CDN 加速</strong></p>\n<h1 id=\"项目部署\"><a class=\"markdownIt-Anchor\" href=\"#项目部署\">#</a> 项目部署</h1>\n<h2 id=\"环境\"><a class=\"markdownIt-Anchor\" href=\"#环境\">#</a> 环境</h2>\n<blockquote>\n<p>1.ubuntu18.04</p>\n<p>2.nginx-1.14.0</p>\n<p>3.php-fpm7.2</p>\n</blockquote>\n<h2 id=\"安装\"><a class=\"markdownIt-Anchor\" href=\"#安装\">#</a> 安装</h2>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt update</span><br><span class=\"line\"></span><br><span class=\"line\"># 安装nginx</span><br><span class=\"line\"></span><br><span class=\"line\">sudo apt install nginx</span><br><span class=\"line\"></span><br><span class=\"line\"># 安装php-fpm</span><br><span class=\"line\">sudo apt-get install php7.2-fpm</span><br><span class=\"line\"></span><br><span class=\"line\">#配置php-fpm</span><br><span class=\"line\"></span><br><span class=\"line\">sudo vi &#x2F;etc&#x2F;php&#x2F;7.2&#x2F;fpm&#x2F;php.ini</span><br><span class=\"line\"></span><br><span class=\"line\">将;cgi.fix_pathinfo&#x3D;1改成cgi.fix_pathinfo&#x3D;0(还要去掉分号)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><strong>配置 nginx</strong></p>\n<p><strong>sudo vim /etc/nginx/sites-available/default</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server &#123;</span><br><span class=\"line\">listen 80 default_server;</span><br><span class=\"line\">listen [::]:80 default_server;</span><br><span class=\"line\"></span><br><span class=\"line\"># SSL configuration</span><br><span class=\"line\">#</span><br><span class=\"line\"># listen 443 ssl default_server;</span><br><span class=\"line\"># listen [::]:443 ssl default_server;</span><br><span class=\"line\">#</span><br><span class=\"line\"># Note: You should disable gzip for SSL traffic.</span><br><span class=\"line\"># See: https:&#x2F;&#x2F;bugs.debian.org&#x2F;773332</span><br><span class=\"line\">#</span><br><span class=\"line\"># Read up on ssl_ciphers to ensure a secure configuration.</span><br><span class=\"line\"># See: https:&#x2F;&#x2F;bugs.debian.org&#x2F;765782</span><br><span class=\"line\">#</span><br><span class=\"line\"># Self signed certs generated by the ssl-cert package</span><br><span class=\"line\"># Don&#39;t use them in a production server!</span><br><span class=\"line\">#</span><br><span class=\"line\"># include snippets&#x2F;snakeoil.conf;</span><br><span class=\"line\"></span><br><span class=\"line\">root &#x2F;var&#x2F;www&#x2F;html;</span><br><span class=\"line\"></span><br><span class=\"line\"># Add index.php to the list if you are using PHP</span><br><span class=\"line\">index index.html index.htm index.nginx-debian.html;</span><br><span class=\"line\"></span><br><span class=\"line\">server_name _;</span><br><span class=\"line\"></span><br><span class=\"line\">location &#x2F; &#123;</span><br><span class=\"line\">\t# First attempt to serve request as file, then</span><br><span class=\"line\">\t# as directory, then fall back to displaying a 404.</span><br><span class=\"line\">\ttry_files $uri $uri&#x2F; &#x3D;404;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"># pass PHP scripts to FastCGI server</span><br><span class=\"line\">#</span><br><span class=\"line\">#location ~ \\.php$ &#123;</span><br><span class=\"line\">#include snippets&#x2F;fastcgi-php.conf;</span><br><span class=\"line\">#</span><br><span class=\"line\">#\t# With php-fpm (or other unix sockets):</span><br><span class=\"line\">\tfastcgi_pass unix:&#x2F;var&#x2F;run&#x2F;php&#x2F;php7.0-fpm.sock;</span><br><span class=\"line\">#\t# With php-cgi (or other tcp sockets):</span><br><span class=\"line\">#\tfastcgi_pass 127.0.0.1:9000;</span><br><span class=\"line\">#&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"># deny access to .htaccess files, if Apache&#39;s document root</span><br><span class=\"line\"># concurs with nginx&#39;s one</span><br><span class=\"line\">#</span><br><span class=\"line\">#location ~ &#x2F;\\.ht &#123;</span><br><span class=\"line\">#\tdeny all;</span><br><span class=\"line\">#&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>修改</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">location ~ \\.php$ &#123;</span><br><span class=\"line\">\tinclude snippets&#x2F;fastcgi-php.conf;</span><br><span class=\"line\">#</span><br><span class=\"line\">#\t# With php-fpm (or other unix sockets):</span><br><span class=\"line\">\tfastcgi_pass unix:&#x2F;var&#x2F;run&#x2F;php&#x2F;php7.2-fpm.sock;</span><br><span class=\"line\">#\t# With php-cgi (or other tcp sockets):</span><br><span class=\"line\">#\tfastcgi_pass 127.0.0.1:9000;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>安装依赖</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install php7.2-xml</span><br><span class=\"line\">sudo apt-get install php-curl</span><br></pre></td></tr></table></figure>\n<p><strong>重启</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo service nginx restart</span><br><span class=\"line\">sudo service php7.2-fpm restart</span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "web"
            ]
        }
    ]
}